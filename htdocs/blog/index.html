<?php
$listMgr = (new \tomk79\pickles2\pageListGenerator\main($px))->create(
	function($page_info){
		if(@$page_info['article_flg']){
			return true;
		}
		return false;
	} ,
	array(
		'domain'=>'pickles2.pxt.jp',
		'title'=>'Pickles 2 Developers BLOG',
		'description'=>'Pickles 2 プロジェクトの開発者によるブログです。',
		'lang'=>'ja',
		'url_home'=>'http://pickles2.pxt.jp/',
		'url_index'=>'http://pickles2.pxt.jp/blog/',
		'author'=>'Pickles 2 Project',
		'rss'=>array(
			'atom-1.0'=>$px->get_path_docroot().'rss/px2_dev_blog_atom0100.xml',
			'rss-1.0'=>$px->get_path_docroot().'rss/px2_dev_blog_rss0100.rdf',
			'rss-2.0'=>$px->get_path_docroot().'rss/px2_dev_blog_rss0200.xml',
		)
	)
);

if( $px->get_status() !== 200 ){
	$px->bowl()->send('<p>'.htmlspecialchars($px->get_status()).' - '.htmlspecialchars($px->get_status_message()).'</p>');
	return;
}
$list = $listMgr->get_list();
$pager = $listMgr->mk_pager();
?>

<?php print $pager; ?>

<?php foreach( $list as $row ){ ?>
<div class="cont_plog_article">
<h2><a href="<?= htmlspecialchars( $px->href( $row['path'] ) ); ?>"><?= htmlspecialchars( $row['title'] ); ?></a></h2>
<p><?= preg_replace('/\r\n|\r|\n/s', '<br />', htmlspecialchars($row['article_summary']) ); ?></p>
<div class="small">
	公開日：<?= htmlspecialchars( @date('Y年m月d日(D)', strtotime($row['release_date'])) ); ?>
</div>
<ul class="horizontal">
	<li class="small horizontal-li"><a href="<?= htmlspecialchars( $px->href( $row['path'] ) ); ?>" class="px2-link px2-link--burette">記事を読む</a></li>
</ul>
</div>

<?php } ?>


<?php print $pager; ?>
