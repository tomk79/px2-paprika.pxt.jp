<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>GUIモジュール定義 | Paprika Framework</title>

<meta property="og:site_name" content="Paprika Framework" />
<meta property="og:title" content="GUIモジュール定義 | Paprika Framework" />
<meta property="og:type" content="blog" />
<meta property="og:url" content="http://px2-paprika.pxt.jp/manual/guieditor/designing_modules/" />
<meta property="og:image" content="http://pickles2.pxt.jp/common/images/og_image.png" />
<link rel="canonical" href="http://px2-paprika.pxt.jp/manual/guieditor/designing_modules/" />
<link rel="icon" href="../../../common/images/favicon.png" type="image/png" />
<meta name="apple-mobile-web-app-capable" content="no" /><meta name="format-detection" content="telephone=no" /><link rel="apple-touch-icon" href="../../../common/images/apple-touch-icon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="keywords" content="" />
		<meta name="description" content="" />

 
<!-- jQuery -->
<script src="../../../common/scripts/jquery-1.10.1.min.js" type="text/javascript"></script>

<!-- Bootstrap -->
<link rel="stylesheet" href="../../../common/styles/bootstrap/css/bootstrap.min.css">
<script src="../../../common/styles/bootstrap/js/bootstrap.min.js"></script>

<!-- px2style -->
<link rel="stylesheet" href="../../../common/px2style/dist/styles.css" type="text/css" />
<script src="../../../common/px2style/dist/scripts.js"></script>

<!-- Contents Stylesheets -->
<link rel="stylesheet" href="../../../common/styles/contents.css" type="text/css" />

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-3100892-11', 'auto');
  ga('send', 'pageview');
</script>

		<!-- Adobe Typekit -->
		<script src="https://use.typekit.net/erd0xqv.js"></script>
		<script>try{Typekit.load({ async: true });}catch(e){}</script>

		<!-- Bootstrap Theme -->
		<link rel="stylesheet" href="../../../caches/p/theme/pickles/styles/bootstrap-theme.min.css">
		<link rel="stylesheet" href="../../../caches/p/theme/pickles/styles/theme.css">

		<!-- Font Awesome -->
		<link rel="stylesheet" href="../../../caches/p/theme/pickles/libs/font-awesome-4.6.3/css/font-awesome.min.css" />

		<!-- highlight.js -->
		<link rel="stylesheet" href="../../../caches/p/theme/pickles/libs/highlight.js/styles/github.css">
		<script src="../../../caches/p/theme/pickles/libs/highlight.js/highlight.pack.js"></script>
		<script>
			$(document).ready(function() {
				$('pre code').each(function(i, block) {
					hljs.highlightBlock(block);
				});
			});
		</script>

		<script>
			// Adobe Typekit
			$(function(){
				var mutObs = new MutationObserver(function(records, observer){
					// console.log('MutationObserver() callback');
					// console.log(records);
					// console.log(observer);

					for( var idx in records ){
						var $tgt = $(records[idx].target);
						// $tgt.find('h1,h2,h3,h4,h5,h6')
						// 	.removeClass('tk-ryo-gothic-plusn')
						// 	.removeClass('tk-skolar-sans-latin')
						// 	.addClass('tk-ryo-gothic-plusn')
						// ;
						$tgt.find('.theme_welcome h1').removeClass('tk-ryo-gothic-plusn').addClass('tk-skolar-sans-latin');
						$tgt.find('.theme_welcome p').addClass('tk-ryo-gothic-plusn');

						// $tgt.find('.theme_header').addClass('tk-ryo-gothic-plusn');
						// $tgt.find('.theme_footer').addClass('tk-ryo-gothic-plusn');
						// $tgt.find('.theme_breadcrumb').addClass('tk-ryo-gothic-plusn');
						$tgt.find('.theme_si').removeClass('tk-ryo-gothic-plusn').addClass('tk-skolar-sans-latin');
					}

				});
				mutObs.observe($('body').get(0), {
					childList: true,
					subtree: true
				});

			});
		</script>
	</head>
	<body class="default">
		<header class="theme_header" id="page_top">
			<div class="container">
				<p class="theme_si"><a href="../../../"><img src="../../../caches/p/theme/pickles/images/logo_2017.svg" alt="Paprika Framework" /></a></p>
				<div class="theme_shouldernavi">
<ul><li><a href="../../../developers/">開発者向けの情報</a></li></ul>				</div>
				<div class="theme_globalnavi">
<ul><li><a href="../../../overview/about/">はじめに</a></li><li><a href="../../../download/">ダウンロード</a></li><li><a href="../../" class="current">使い方</a></li><li><a href="../../../tools/">ツール・リソース</a></li><li><a href="../../../blog/">BLOG</a></li><li><a href="../../../usergroups/">ユーザーグループ</a></li></ul>
				</div>
			</div>
		</header>
		<div class="theme_mainblock">
			<div class="container theme_common_navi_frame">
				<div class="row">
					<div class="col-sm-9">
						<div class="theme_breadcrumb"><ul><li><a href="../../../">HOME</a></li><li><a href="../../">使い方</a></li><li><a href="../">GUI編集</a></li><li><span>GUIモジュール定義</span></li></ul></div>
						<h1>GUIモジュール定義</h1>


						<div class="contents">
<p>Pickles 2 Desktop Tool のGUI編集機能は、個別に設計された小さな部品 <strong>ドキュメントモジュール</strong> を組み合わせて構築するインターフェイスです。</p>

<p>ここでは、ドキュメントモジュールのテンプレートを定義する方法について説明します。</p>

<!-- == autoindex == -->
<div style="margin:2em 5%; border:1px solid #bbb; padding:1em; background:rgba(124, 124, 124, 0.05); border-radius:5px;">
<div style="margin:0; padding:0; text-align:center; font-weight:bold;">INDEX</div><ul style="margin:0; padding:0 0 0 2em;"><li style="list-style-type:disc; display:list-item;"><a href="#hash_ディレクトリとファイルの構成">ディレクトリとファイルの構成</a><ul style="margin:0; padding:0 0 0 2em;"><li style="list-style-type:disc; display:list-item;"><a href="#hash_モジュールの単位とディレクトリ構成">モジュールの単位とディレクトリ構成</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_パッケージ1つあたりのファイル構成">パッケージ1つあたりのファイル構成</a><ul style="margin:0; padding:0 0 0 2em;"><li style="list-style-type:disc; display:list-item;"><a href="#hash_info.json">info.json</a></li></ul></li><li style="list-style-type:disc; display:list-item;"><a href="#hash_カテゴリ1つあたりのファイル構成">カテゴリ1つあたりのファイル構成</a><ul style="margin:0; padding:0 0 0 2em;"><li style="list-style-type:disc; display:list-item;"><a href="#hash_2_info.json">info.json</a></li></ul></li><li style="list-style-type:disc; display:list-item;"><a href="#hash_モジュール1つあたりのファイル構成">モジュール1つあたりのファイル構成</a><ul style="margin:0; padding:0 0 0 2em;"><li style="list-style-type:disc; display:list-item;"><a href="#hash_template.html">template.html</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_module.css_(または_module.css.scss)">module.css (または module.css.scss)</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_module.js">module.js</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_finalize.js">finalize.js</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_thumb.png">thumb.png</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_3_info.json">info.json</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_README.html_(または_README.md)">README.html (または README.md)</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_pics/*.png">pics/*.png</a></li></ul></li><li style="list-style-type:disc; display:list-item;"><a href="#hash_クリップモジュール">クリップモジュール</a></li></ul></li><li style="list-style-type:disc; display:list-item;"><a href="#hash_モジュールをプロジェクトに登録する">モジュールをプロジェクトに登録する</a><ul style="margin:0; padding:0 0 0 2em;"><li style="list-style-type:disc; display:list-item;"><a href="#hash_Config_画面を開く">Config 画面を開く</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_Config_にディレクトリを登録">Config にディレクトリを登録</a></li></ul>
</li></ul>
</div>
<!-- / == autoindex == -->


<span id="hash_ディレクトリとファイルの構成"></span><h2>ディレクトリとファイルの構成</h2>

<span id="hash_モジュールの単位とディレクトリ構成"></span><h3>モジュールの単位とディレクトリ構成</h3>

<p>モジュールは、次のようなディレクトリ構成で表現されます。</p>

<pre><code>└─ package/ (root)
  ├─ info.json
  ├─ category1/
  │　├─ info.json
  │　├─ module1/
  │　│　├─ README.md
  │　│　├─ info.json
  │　│　├─ template.html
  │　│　├─ module.css
  │　│　├─ module.js
  │　│　├─ finalize.js
  │　│　├─ thumb.png
  │　│　└─ pics/
  │　│　 　├─ pic1.png
  │　│　 　├─ pic2.png
  │　│　 　├─ ・・・
  │　│　 　└─ picN.png
  │　│
  │　├─ module2/
  │　├─ module3/
  │　├─ ・・・
  │　└─ moduleN/
  │
  ├─ category2/
  ├─ category3/
  ├─ ・・・
  └─ categoryN/
</code></pre>

<p>この構成を元に、モジュールの識別IDが生成されます。モジュールIDは次のような形式になります。</p>

<ul>
<li>{$mod_package}:{$mod_category}/{$mod_name}/</li>
</ul>

<span id="hash_パッケージ1つあたりのファイル構成"></span><h3>パッケージ1つあたりのファイル構成</h3>

<p><code>{$mod_package}</code> ディレクトリには、各カテゴリディレクトリの他に、次のようなファイルで構成されます。</p>

<ul>
<li>info.json</li>
</ul>

<span id="hash_info.json"></span><h4>info.json</h4>

<p>このJSONファイルには、パッケージの詳細な付加情報を記述します。</p>

<p>下記は記述例です。</p>

<pre><code>{
  "name": "パッケージの論理名称",
  "sort":[
    "category1",
    "category2"
  ],
  "deprecated": false
}
</code></pre>

<p><code>sort</code> には、パッケージに含まれるカテゴリのディレクトリ名を配列で指定します。ここに書かれたカテゴリは優先的に上位に表示され、指定した順番に並べられます。記述のないカテゴリは、成り行き順に最後尾に続いて表示されます。</p>

<p><code>deprecated</code> に <code>true</code> を設定して、パッケージ全体を非推奨モジュールに指定できます。非推奨モジュールにすると、すでに過去に使用しているページは壊さずに、モジュールパレット上から隠し、新規に使用できなくすることができます。</p>

<span id="hash_カテゴリ1つあたりのファイル構成"></span><h3>カテゴリ1つあたりのファイル構成</h3>

<p><code>{$mod_category}</code> ディレクトリには、各モジュールディレクトリの他に、次のようなファイルで構成されます。</p>

<ul>
<li>info.json</li>
</ul>

<span id="hash_2_info.json"></span><h4>info.json</h4>

<p>このJSONファイルには、カテゴリの詳細な付加情報を記述します。</p>

<p>下記は記述例です。</p>

<pre><code>{
  "name": "カテゴリの論理名称",
  "sort":[
    "module1",
    "module2"
  ],
  "deprecated": false
}
</code></pre>

<p><code>sort</code> には、カテゴリに含まれるモジュールのディレクトリ名を配列で指定します。ここに書かれたモジュールは優先的に上位に表示され、指定した順番に並べられます。記述のないモジュールは、成り行き順に最後尾に続いて表示されます。</p>

<p><code>deprecated</code> に <code>true</code> を設定して、カテゴリ全体を非推奨モジュールに指定できます。非推奨モジュールにすると、すでに過去に使用しているページは壊さずに、モジュールパレット上から隠し、新規に使用できなくすることができます。</p>

<span id="hash_モジュール1つあたりのファイル構成"></span><h3>モジュール1つあたりのファイル構成</h3>

<p><code>{$mod_name}</code> ディレクトリの内容は、次のようなファイルで構成されます。</p>

<ul>
<li>template.html</li>
<li>module.css (または module.css.scss)</li>
<li>module.js</li>
<li>thumb.png</li>
<li>info.json</li>
<li>README.html (または README.md)</li>
<li>pics/&#42;.png</li>
</ul>

<span id="hash_template.html"></span><h4>template.html</h4>

<p>このHTMLファイルに、テンプレートの実装を記述します。
テンプレートは、部分だけを切り出した純粋なHTMLをベースに、フィールド(変更可能な箇所を定義するメタ構文)を埋め込むような形式で記述していきます。</p>

<pre><code>&lt;!-- template.html の実装例 --&gt;
&lt;div class="sample_module"&gt;
    &lt;div class="sample_module-inner"&gt;
{&amp;{"module":{"name":"main"}}&amp;}
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>利用可能なフィールドについては、<a href="../fields/">フィールド一覧</a>のページを参照してください。</p>

<p><code>template.html</code> の代わりに、<code>template.html.twig</code> を設置すると、Twigテンプレートエンジンを利用できます。詳しくは、<a href="../designing_modules_with_tplengines/">Twigエンジンを用いたGUIモジュール定義</a> を参照ください。</p>

<span id="hash_module.css_(または_module.css.scss)"></span><h4>module.css (または module.css.scss)</h4>

<p>モジュールに関連するスタイルシートを記述します。
ファイル名の最後に <code>.scss</code> を付加すると、SCSS形式で記述することができます。</p>

<pre><code>// module.css.scss の実装例
.sample_module{
    border: 1px solid #999;
    padding: 15px;
    margin:1em 0;
    &amp;-inner{
        padding: 0;
        margin: 0;
    }
}
</code></pre>

<p>ここに書かれたスタイルは、Pickles2用のプラグイン px2-px2dthelper によって収集・統合し、テーマから自動的に読み込むことができます。</p>

<span id="hash_module.js"></span><h4>module.js</h4>

<p>モジュールの動作に関連するスクリプトを記述します。</p>

<p>ここに書かれたスクリプトは、Pickles2用のプラグイン px2-px2dthelper によって収集・統合し、テーマから自動的に読み込むことができます。</p>

<span id="hash_finalize.js"></span><h4>finalize.js</h4>

<p>ビルドされたモジュールのHTMLコードを、最終的な完成コードに加工するスクリプトを追加します。</p>

<p>例えば、マークダウン記法で作られたシンプルなリスト要素に、クラス名を与えて複雑な装飾を行いたい場合などに利用できます。</p>

<pre><code class="js">/**
 * finalize.js
 */
module.exports = function(html, callback, supply){

    /* ここに加工するコードを書く。 */

    // 完成したHTMLは、callback() に渡して返します。
    callback(html);
    return true;
}
</code></pre>

<p><code>finalize.js</code> は、broccoli-html-editor エンジンでのみ使用できます。</p>

<span id="hash_thumb.png"></span><h4>thumb.png</h4>

<p>thumb.png は、GUI編集画面上での、モジュールのサムネイルとして使用されます。</p>

<p>縦横比 1:1 の画像を登録してください。大きさについては特に規定はありませんが、500px前後で作成されていれば十分でしょう。</p>

<p><code>thumb.png</code> の他にも、<code>thumb.jpg</code>、<code>thumb.gif</code>、<code>thumb.svg</code> が利用できます。</p>

<span id="hash_3_info.json"></span><h4>info.json</h4>

<p>このJSONファイルには、モジュールの詳細な付加情報を記述します。</p>

<p>下記は記述例です。</p>

<pre><code>{
  "name": ".cols (3カラム)",
  "areaSizeDetection": "shallow",
  "enabledParents": ["pkg:cat/mod1"],
  "interface": {},
  "deprecated": false
}
</code></pre>

<dl>
<dt>name</dt><dd>モジュールの名称を設定します。</dd>
<dt>areaSizeDetection</dt><dd>編集画面でモジュールのサイズを測る方法を指定します。<code>deep</code> は、モジュールに含まれるすべての要素のサイズを測り、最大値を探します。<code>shallow</code>を指定すると、ルートノードのみのサイズを測ります。デフォルトは<code>shallow</code>です。</dd>
<dt>enabledParents</dt><dd>このモジュールを挿入できる親モジュールのIDを指定します。文字列または配列で複数指定可能です。 パッケージ名は省略できます。</dd>
<dt>interface</dt><dd>Twigテンプレートエンジンを利用する場合に、入力欄の構造を定義します。詳しくは、<a href="../designing_modules_with_tplengines/">Twigエンジンを用いたGUIモジュール定義</a> を参照してください。</dd>
<dt>deprecated</dt><dd><code>true</code> を設定して、非推奨モジュールに指定できます。非推奨モジュールにすると、すでに過去に使用しているページは壊さずに、モジュールパレット上から隠し、新規に使用できなくすることができます。</dd>
</dl>

<span id="hash_README.html_(または_README.md)"></span><h4>README.html (または README.md)</h4>

<p>モジュールに関する説明などがあれば、このファイルに記述します。</p>

<p>この記述は、自動生成されるスタイルガイドなどに記載されます。</p>

<span id="hash_pics/*.png"></span><h4>pics/*.png</h4>

<p>picsディレクトリに置かれた画像は、README.html(.md) と共にスタイルガイドなどに表示されます。
モジュール名だけでは内容を把握しにくかったり、微妙に異なる他のモジュールと区別しなければならない場合などに、ユーザーの判断を助けるヒントとして活用できます。</p>

<span id="hash_クリップモジュール"></span><h3>クリップモジュール</h3>

<p>クリップモジュールは、特殊なモジュール形態です。</p>

<p>他のモジュールを組み合わせて予めプリセットを構成し、コンテンツに配置することができます。</p>

<p><code>template.html</code> を置かず、代わりに <code>clip.json</code> を設置すると、クリップモジュールとして認識されます。</p>

<p><code>clip.json</code> の編集手順は次の通りです。</p>

<ol>
<li>任意のコンテンツをGUI編集します。</li>
<li>クリップしたいインスタンスを選択し、コピーします。この操作で、JSON形式のテキストがクリップボードにコピーされます。</li>
<li>この状態で clip.json を開き、ペーストします。</li>
</ol>

<span id="hash_モジュールをプロジェクトに登録する"></span><h2>モジュールをプロジェクトに登録する</h2>

<p>モジュールの定義ができたら、コンフィグ画面からモジュールとして登録します。</p>

<span id="hash_Config_画面を開く"></span><h3>Config 画面を開く</h3>

<p>サブメニュー内にある <code>Config</code> を開きます。</p>

<span id="hash_Config_にディレクトリを登録"></span><h3>Config にディレクトリを登録</h3>

<p>Pickles 2 Desktop Tool の設定は、Pickles 2 の Config <code>$conf-&gt;plugins-&gt;px2dt</code> に記述します。 次の例を参考に、<code>paths_module_template</code> 欄にモジュールのパスを設定してください。</p>

<pre><code class="php">@$conf-&gt;plugins-&gt;px2dt-&gt;paths_module_template = [
  "SELF" =&gt; "./px-files/resources/module_templates/"
];
</code></pre>

<p>モジュールのセットは、1つのプロジェクトにつき複数登録することができます。</p>

<p><code>paths_module_template</code> の添字(上記の例では、"SELF")は、モジュールのIDの一部として利用されます。コンテンツに使用した後から変更すると、モジュール構造が壊れ、作成済みのコンテンツが失われる場合がありますので注意してください。添字には、半角英数字と、ハイフン、アンダースコア が使えます。</p>

<p>Pickles 2 の Config は、<code>./px-files/config.php</code> に保存されます。</p>
						</div>



					</div>
					<div class="col-sm-3">
						<nav class="theme_common_navi">
							<p><a href="../../">使い方</a></p>
<ul>
<li><a href="../../system_structure/">システムの構成</a></li>
<li><a href="../../setup/">セットアップ手順</a></li>
<li><a href="../../configs/">設定</a></li>
<li><a href="../../sitemap/">サイトマップ編集</a></li>
<li><a href="../../theme/">テーマ編集</a></li>
<li><a href="../../contents/">コンテンツ編集</a></li>
<li><a href="../../publish/">パブリッシュ</a></li>
<li><a href="../../cmd_options/">コマンドラインオプション</a></li>
<li><a href="../../plugins/">プラグイン</a></li>
<li><a href="../../pxcommands/">PXコマンド</a></li>
<li><a href="../" class="current">GUI編集</a><ul>
<li><a href="../setting_pickles2/">GUI編集を使うための Pickles 2 の設定</a></li>
<li><a href="./" class="current">GUIモジュール定義</a></li>
<li><a href="../designing_modules_with_tplengines/">Twigエンジンを用いたGUIモジュール定義</a></li>
<li><a href="../fields/">フィールド一覧</a></li>
<li><a href="../select_gui_engine/">GUI編集エンジンの種類と切り替え方法</a></li>
</ul>
</li>
<li><a href="../../contents_manifesto/">Contents Manifesto</a></li>
<li><a href="../../api_reference/">API リファレンス</a></li>
</ul>
						</nav>
					</div>
				</div><!-- /.row -->
			</div><!-- /.container -->
			<div class="container">
				<div class="theme_backtotop"><a href="#page_top"><i class="fa fa-arrow-up"></i> back to top</a></div>
				<div class="theme_breadcrumb"><ul><li><a href="../../../">HOME</a></li><li><a href="../../">使い方</a></li><li><a href="../">GUI編集</a></li><li><span>GUIモジュール定義</span></li></ul></div>
			</div><!-- /.container -->
		</div><!-- /.theme_mainblock -->
		<footer class="theme_footer">
			<div class="theme_container">
				<nav class="theme_megafooter_navi">
<ul><li><a href="../../../overview/about/">はじめに</a></li><li><a href="../../../download/">ダウンロード</a></li><li><a href="../../" class="current">使い方</a></li><li><a href="../../../tools/">ツール・リソース</a></li><li><a href="../../../blog/">BLOG</a></li><li><a href="../../../usergroups/">ユーザーグループ</a></li></ul>				</nav>
			</div>
			<div class="theme_container theme_footer_shouldernavi">
<ul><li><a href="../../../">HOME</a></li><li><a href="../../../developers/">開発者向けの情報</a></li></ul>			</div>
			<div class="theme_container theme_footer_searcher">
				<form action="../../../search/" class="form-inline">
					<div class="form-group">
						<label>サイト内検索</label>
						<input type="text" name="q" value="" class="form-control" />
						<button class="form-control">検索</button>
					</div>
				</form>
			</div>
			<div class="theme_container">
				<div class="theme_social_icons">
					<a href="https://twitter.com/pxfw" target="_blank" title="Pickles 2 on Twitter"><i class="fa fa-twitter"></i></a>
					<a href="https://github.com/pickles2" target="_blank" title="Pickles 2 on github"><i class="fa fa-github"></i></a>
				</div>
			</div>
			<div class="theme_container">
				<p style="text-align:center;">&copy;Pickles 2 Project.</p>
			</div>
		</footer>
		<script src="../../../caches/p/theme/pickles/scripts/smoothScroll.js"></script>
		<script src="../../../caches/p/theme/pickles/scripts/global.js"></script>
		<script src="../../../caches/p/theme/pickles/scripts/jquery.sidebarFix.js"></script>
		<script type="text/javascript">
			$(window).load(function(){
				$('.theme_common_navi').sidebarFix({
					'frame': $('.theme_common_navi_frame'),
					'topBuffer': 98
				});
			});
		</script>
	</body>
</html>
